---
// This is the frontmatter - we can add JavaScript here if needed

// Import the CSS file
import "./styles/landing.css";
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Langmate - Practice Languages with Native Speakers</title>
		<meta
			name="description"
			content="Practice languages with native speakers through structured video sessions. Join timed conversations and improve your fluency with real people from around the world."
		/>
	</head>
	<body>
		<main class="container">
			<div class="content">
				<!-- Main heading with logo -->
				<div class="title">
					<img src="/logo.svg" alt="Langmate" class="logo" />
					<div class="title-underline"></div>
				</div>

				<!-- Subtitle -->
				<h2 class="subtitle">
					Practice languages with native speakers through<br />
					structured video sessions
				</h2>

				<!-- Description -->
				<p class="description">
					Join timed conversations, swap roles naturally, and improve<br
					/>
					your fluency with real people from around the world.
				</p>

				<!-- Email signup form with Netlify integration -->
				<div id="signup-section">
					<form name="email-signup" method="POST" class="signup-form">
						<input
							type="hidden"
							name="form-name"
							value="email-signup"
						/>

						<div class="form-group">
							<input
								type="email"
								name="email"
								placeholder="Enter your email"
								required
								class="email-input"
							/>
							<button type="submit" class="submit-button">
								Get Early Access
							</button>
						</div>
					</form>

					<!-- Share button for initial page -->
					<button class="share-button" onclick="shareContent()">
						<svg
							width="16"
							height="16"
							viewBox="0 0 24 24"
							fill="currentColor"
						>
							<path
								d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92S19.61 16.08 18 16.08z"
							></path>
						</svg>
						Share Langmate
					</button>
				</div>

				<!-- Success section (hidden initially) -->
				<div
					id="success-section"
					class="success-section"
					style="display: none;"
				>
					<div class="success-message-large">
						<div class="success-icon">✅</div>
						<h3>Thanks! You're on the list</h3>
						<p>You'll be notified when Langmate launches</p>
					</div>

					<div class="share-prompt">
						<p class="share-text">Help us spread the word!</p>
						<button
							class="share-button-primary"
							onclick="shareContent()"
						>
							<svg
								width="18"
								height="18"
								viewBox="0 0 24 24"
								fill="currentColor"
							>
								<path
									d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92S19.61 16.08 18 16.08z"
								></path>
							</svg>
							Share Langmate with Friends
						</button>
					</div>
				</div>

				<!-- Form response message (for errors) -->
				<div id="form-response" class="form-response"></div>

				<!-- Footer text -->
				<p class="footer-text">Coming soon • No spam, I promise!</p>
				<p class="footer-text">
					Langmate is a project by
					<a href="https://www.linkedin.com/in/seraphim-sakiewicz/"
						>Seraphim Sakiewicz</a
					>
				</p>
			</div>
		</main>
		<script>
			// @ts-nocheck
			function submitForm(e) {
				e.preventDefault();
				const form = e.target;
				const formData = new FormData(form);

				// Show loading state
				const button = form.querySelector(".submit-button");
				const responseDiv = document.getElementById("form-response");

				if (!button || !responseDiv) return;

				const originalText = button.textContent;
				button.textContent = "Sending...";
				button.disabled = true;

				fetch("/", {
					method: "POST",
					headers: {
						"Content-Type": "application/x-www-form-urlencoded",
					},
					body: new URLSearchParams(formData).toString(),
				})
					.then(() => {
						// Hide the signup section and show success section
						document.getElementById(
							"signup-section",
						).style.display = "none";
						document.getElementById(
							"success-section",
						).style.display = "block";

						// Clear any error messages
						responseDiv.innerHTML = "";

						document
							.querySelector(".share-button-primary")
							?.addEventListener("click", shareContent);
					})
					.catch((error) => {
						responseDiv.innerHTML =
							"<p class='error-message'>Oops! Something went wrong. Try again later.</p>";
					})
					.finally(() => {
						button.textContent = originalText;
						button.disabled = false;
					});
			}

			// Share functionality
			async function shareContent() {
				const shareData = {
					title: "Langmate - Practice Languages with Native Speakers",
					text: "Check out Langmate! Practice languages through structured video sessions with native speakers.",
					url: window.location.href,
				};

				try {
					// Try Web Share API first (mobile-friendly)
					if (navigator.share) {
						await navigator.share(shareData);
					} else {
						// Fallback: copy to clipboard
						await navigator.clipboard.writeText(
							`${shareData.text} ${shareData.url}`,
						);

						// Show temporary feedback
						const button =
							event.target.closest(".share-button") ||
							event.target.closest(".share-button-primary");
						const originalText = button.innerHTML;
						button.innerHTML =
							"<span>✅ Copied to clipboard!</span>";

						setTimeout(() => {
							button.innerHTML = originalText;
						}, 2000);
					}
				} catch (error) {
					console.log("Share failed:", error);
				}
			}

			// Add event listener after DOM loads
			document.addEventListener("DOMContentLoaded", () => {
				document
					.querySelector(".signup-form")
					?.addEventListener("submit", submitForm);

				document
					.querySelector(".share-button")
					?.addEventListener("click", shareContent);
			});
		</script>
	</body>
</html>
